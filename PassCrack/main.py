"""Main module for HashCrack. Imports functions from functions.py"""
import pyfiglet

from functions import hash_choice, wordlist_choice, bruteforce


HASHCRACK = pyfiglet.figlet_format("Hash Cracker")


def main():
    """
    Main function which calls upon other functions and enables restart.
    """
    while True:
        #Display at startscreen
        print(HASHCRACK)
        print(
            "| MD5 | SHA1 | SHA224 | SHA256 | SHA384 | SHA512 | " 
            "BLAKE2B | BLAKE2S |\n| SHA3_224 | SHA3_256 | "
            "SHA3_384 | SHA3_512 | SHAKE_128 | SHAKE_256 |"
        )

        #function returns str: md5, sha1 etc
        algorithm = hash_choice()

        given_hash = input("Enter hash:")

        #Returns a list of words wich can be hashed and crosschecked
        wordlist = wordlist_choice()

        #main function, combines previous 3 inputs and returns
        #clear text password or None
        password = bruteforce(wordlist, given_hash, algorithm)
        print("The password is:     ", password)

        #Repeats program if input is "y", all other input shuts it down
        again = input("\n\ngo again? y/n")
        if again.lower() != "y":
            break

if __name__ == '__main__':
    main()


#################### IDEAS to add in the future #######################
#add functionality to add a url and make the program enumerate and
#create a new wordlist out of the website, ie scrape words make list
#   1. enter path
#   2. enter URL
#   3. Use embedded
#   4. create new from URL      <-----
#
#add choice for UTF-8 or other (low priority)
#
#add more embedded lists
#
#make it possible to run through all encryptions one by one with
#any or all wordlists
#
#export to standalone program with graphics
